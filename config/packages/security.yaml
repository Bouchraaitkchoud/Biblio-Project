# security:
#     password_hashers:
#         Symfony\Component\Security\Core\User\PasswordAuthenticatedUserInterface: 'auto'
#     providers:
#         users_in_memory:
#             memory:
#                  users:
#                     user1:
#                         password: password123
#                         roles: ROLE_USER
#         app_user_provider:
#             entity:
#                 class: App\Entity\User
#                 property: email
#     firewalls:
#         dev:
#             pattern: ^/(_(profiler|wdt)|css|images|js)/
#             security: false
#         main:
#             lazy: true
#             provider: app_user_provider
#             stateless: false
#             entry_point: form_login
#             http_basic:
#                 realm: Secured Area
#             # json_login:
#             #     check_path: /api/login
#             #     username_path: email
#             #     password_path: password
#             form_login:
#                 login_path: app_login
#                 check_path: app_login
#                 enable_csrf: true
#             logout:
#                 path: app_logout
#                 target: app_homepage
#             # Replace "anonymous: true" with the following:
#             security: true

#     access_control:
#         - { path: ^/admin, roles: ROLE_ADMIN }
#         - { path: ^/profile, roles: ROLE_USER }
#         - { path: ^/student, roles: ROLE_STUDENT }

# when@test:
#     security:
#         password_hashers:
#             Symfony\Component\Security\Core\User\PasswordAuthenticatedUserInterface:
#                 algorithm: auto
#                 cost: 4
#                 time_cost: 3
#                 memory_cost: 10
security:
  enable_authenticator_manager: true
  password_hashers:
    Symfony\Component\Security\Core\User\PasswordAuthenticatedUserInterface: "auto"
  providers:
    app_user_provider:
      entity:
        class: App\Entity\User
        property: email

  role_hierarchy:
    # Full admin should automatically include basic user rights.
    ROLE_ADMIN: [ROLE_USER]
    # Limited admin may not have full admin rights, but you give it a base inheritance.
    ROLE_LIMITED_ADMIN: [ROLE_USER]
    # Note: the extra roles (e.g., ROLE_GERER_UTILISATEURS) remain separate.
  
  firewalls:
    dev:
      pattern: ^/(_(profiler|wdt)|css|images|js)/
      security: false
    main:
      lazy: true
      provider: app_user_provider
      form_login:
        login_path: app_login
        check_path: app_login
        default_target_path: home
        enable_csrf: false
        success_handler: App\Security\LoginSuccessHandler
        use_referer: true
        always_use_default_target_path: false
        target_path_parameter: _target_path
      logout:
        path: app_logout
        target: app_login
    admin:
      pattern: ^/admin
      provider: app_user_provider
      form_login:
        login_path: app_admin_login
        check_path: app_admin_check
        default_target_path: admin_dashboard
        enable_csrf: true
      logout:
        path: /admin/logout

  access_control:
    - { path: ^/login, roles: PUBLIC_ACCESS }
    - { path: ^/register, roles: PUBLIC_ACCESS }
    - { path: ^/admin/login, roles: PUBLIC_ACCESS }
    - { path: ^/admin/authors, roles: [ROLE_ADMIN, ROLE_GERER_AUTEURS] }
    - { path: ^/admin/users, roles: [ROLE_ADMIN, ROLE_GERER_UTILISATEURS] }
    - { path: ^/admin/books, roles: [ROLE_ADMIN, ROLE_GERER_LIVRES] }
    - { path: ^/admin/returns, roles: [ROLE_ADMIN, ROLE_GERER_RETOURS] }
    - { path: ^/admin/publishers, roles: [ROLE_ADMIN, ROLE_GERER_EDITEURS] }
    - { path: ^/admin/disciplines, roles: [ROLE_ADMIN, ROLE_GERER_DISCIPLINES] }
    - { path: ^/admin/orders, roles: [ROLE_ADMIN, ROLE_GERER_COMMANDES] }
    - { path: ^/, roles: ROLE_USER }
